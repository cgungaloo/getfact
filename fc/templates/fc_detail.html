{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
    <head>
        <script src="{% static 'js/jquery.js' %}"></script>
        <script src="{% static 'js/ajax-js.js' %}"></script>
    </head>
	<div class="fact_detail">
    <div class="post">
        {% if fc.published_date %}
            <div class="date">
                {{ fc.published_date }}
            </div>
        {% endif %}
        <h1>{{ fc.title }}</h1>
        <img src="{{ fc.author.profile.image.url }}" width="240">
        <p>{{ fc.author }}</p>
        <p>{{ fc.text|linebreaksbr }}</p>
        <strong>Likes: </strong><strong id="like_count">{{ fc.totalLikes }}</strong> 
        <strong>Dislikes: </strong><strong id="dislike_count">{{ fc.totalDislikes }}</strong> 
        <button id="likes" data-fcid="{{fc.id}}" class="btn btn-primary" type="button">
            <span class="glyphicon glyphicon-thumbs-up"></span>
            Like
        </button>

        <button id="dislikes" data-fcid="{{fc.id}}" class="btn btn-primary" type="button">
            <span class="glyphicon glyphicon-thumbs-down"></span>
            Dislike
        </button>

        {% if user.is_authenticated %}
        	{% if fc.author == user %}
        		<a class="btn btn-default" href="{% url 'fc_edit' pk=fc.pk %}">Edit</a>
                <a class="btn btn-default" href="{% url 'fc_delete' pk=fc.pk %}">Delete</a>
        	{% endif %}
        	<a href="{% url 'add_comment_to_post' pk=fc.pk %}">Check Fact</a>
        {% else %}
        	<a href="{% url 'login' %}">Log in to check fact</a>
        {% endif %}
    </div>

    {% for comment in fc.comments.all %}
    <div class="comment">
        <div class="date">{{ comment.created_date }}</div>
        <strong>{{ comment.author }}</strong>
        <p>{{ comment.text|linebreaks }}</p>
        {% if user.is_authenticated %}
            {% if comment.author == user %}
                <a class="btn btn-default" href="{% url 'delete_comment' pk=comment.pk fpk=fc.pk %}">Delete</a>
            {% endif %}
        {% endif %}
    </div>
	{% empty %}
    	<p>No fact checks yet, keep hope alive ;)</p>
	{% endfor %}
	</div>
{% endblock %}